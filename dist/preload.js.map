{"version":3,"file":"preload.js","sources":["../src/common/logger.ts","../src/preload/api/file.ts","../src/common/ipcevents.ts","../src/preload/api/compilers.ts","../src/preload/api/path.ts","../src/preload/api/internal.ts","../src/preload/index.ts"],"sourcesContent":["export type LogType = keyof typeof console;\r\n\r\nexport class LoggerModule {\r\n    module: string;\r\n\r\n    constructor(name: string) {\r\n        this.module = name;\r\n    }\r\n\r\n    #parseType(type: LogType) {\r\n        switch (type) {\r\n            case \"info\":\r\n            case \"warn\":\r\n            case \"error\":\r\n            case \"debug\":\r\n                return type;\r\n            default:\r\n                return \"log\";\r\n        }\r\n    }\r\n\r\n    #log(type: LogType,  ...message: any[]) {\r\n        console[this.#parseType(type)](`%c[HolyMod]%c %c[${this.module}]%c`, \"color: #fff133; font-weight: 700;\", \"\", \"color: #fff133;\", \"\", ...message);\r\n    }\r\n\r\n    log(...message: any[]) {this.#log(\"log\", ...message);}\r\n    info(...message: any[]) {this.#log(\"info\", ...message);}\r\n    warn(...message: any[]) {this.#log(\"warn\", ...message);}\r\n    error(...message: any[]) {this.#log(\"error\", ...message);}\r\n    debug(...message: any[]) {this.#log(\"debug\", ...message);}\r\n\r\n    static create(name: string) {\r\n        return new LoggerModule(name);\r\n    }\r\n}\r\n\r\nexport default LoggerModule;","import fs from \"fs\";\r\n\r\nexport function readFile(path: string, options: string = \"utf8\"): string {\r\n    return fs.readFileSync(path, options as \"utf8\");\r\n};\r\n\r\nexport function createFile(path: string, content: string | NodeJS.ArrayBufferView, options: any): void {\r\n    fs.writeFileSync(path, content, options);\r\n}\r\n\r\nexport function deleteFile(path: string): void {\r\n    return fs.unlinkSync(path);\r\n};\r\n\r\nexport function exists(path: string): boolean {\r\n    return fs.existsSync(path);\r\n};\r\n\r\nexport function readDirectory(path: string): string[] {\r\n    return fs.readdirSync(path);\r\n};\r\n\r\nexport function createDirectory(path: string, options: any): void | boolean | string {\r\n    return fs.mkdirSync(path, options);\r\n};\r\n\r\nexport function deleteDirectory(path: string, options: any): void {\r\n    return fs.rmdirSync(path, options);\r\n};\r\n\r\nexport function getStats(path: string): {\r\n    isFile(): boolean;\r\n    isDirectory(): boolean;\r\n} {\r\n    const stats = fs.statSync(path);\r\n\r\n    return {\r\n        isFile: () => stats.isFile(),\r\n        isDirectory: () => stats.isDirectory()\r\n    };\r\n};","const IPCEvents = {\r\n    COMPILE_SCSS: \"HOLYMOD_COMPILE_SCSS\",\r\n    COMPILE_TYPESCRIPT: \"HOLYMOD_COMPILE_TYPESCRIPT\",\r\n    COMPILE_JAVASCRIPT: \"HOLYMOD_COMPILE_JAVASCRIPT\",\r\n    GET_APP_PATH: \"HOLYMOD_GET_APP_PATH\"\r\n};\r\n\r\nexport default IPCEvents;","import {ipcRenderer as IPC} from \"electron\";\r\nimport IPCEvents from \"../../common/ipcevents\";\r\n\r\nexport function compileJS(path: string): string {\r\n    return IPC.sendSync(IPCEvents.COMPILE_JAVASCRIPT, path);\r\n};\r\n\r\nexport function compileTS(path: string): string {\r\n    return IPC.sendSync(IPCEvents.COMPILE_TYPESCRIPT, path);\r\n};\r\n\r\nexport function compileSCSS(path: string): string {\r\n    return IPC.sendSync(IPCEvents.COMPILE_SCSS, path);\r\n};","import {ipcRenderer as IPC} from \"electron\";\r\nimport IPCEvents from \"../../common/ipcevents\";\r\nimport path from \"path\";\r\n\r\nexport function getBasePath(): string {\r\n    return path.resolve(eval(\"__dirname\"), \"..\");\r\n};\r\n\r\nexport function getAppPath(): string {\r\n    return IPC.sendSync(IPCEvents.GET_APP_PATH);\r\n};\r\n\r\nexport function resolve(...pathSegments: string[]): string {\r\n    return path.resolve(...pathSegments);\r\n};\r\n\r\nexport function dirname(filePath: string): string {\r\n    return path.dirname(filePath);\r\n};\r\n\r\nexport function extname(file: string): string {\r\n    return path.extname(file);\r\n};\r\n\r\nexport function basename(filePath: string): string {\r\n    return path.basename(filePath);\r\n};\r\n\r\nexport function isAbsolute(filePath: string): boolean {\r\n    return path.isAbsolute(filePath);\r\n};","export function unsafeExecuteJS(code: string): any {\r\n    return eval(code);\r\n};","import {contextBridge} from \"electron\";\r\nimport LoggerModule from \"../common/logger\";\r\nimport * as NativeAPI from \"./api\";\r\n\r\nconst Logger = new LoggerModule(\"Preload\");\r\n\r\nconst listeners = {};\r\nconst NativeIPC = {\r\n    on(event: string, listener: Function) {\r\n        if (!listeners[event]) listeners[event] = new Set();\r\n\r\n        listeners[event].add(listener);\r\n\r\n        return () => NativeIPC.off(event, listener);\r\n    },\r\n    off(event: string, listener: Function): boolean {\r\n        if (!listeners[event]) return false;\r\n\r\n        return listeners[event].delete(listener);\r\n    },\r\n    emit(event: string, ...args: any[]) {\r\n        if (!listeners[event]) return null;\r\n        const callbacks = [...listeners[event]];\r\n\r\n        for (let i = 0; i < callbacks.length; i++) {\r\n            try {callbacks[i](...args);}\r\n            catch (error) {console.error(error);}\r\n        }\r\n    }\r\n};\r\n\r\nconst HolyNative = {\r\n    requireModule(module: string) {\r\n        switch (module) {\r\n            case \"API\": return NativeAPI;\r\n            case \"IPC\": return NativeIPC;\r\n        }\r\n    }\r\n};\r\n\r\n// Expose native apis to renderer and respect context isolation.\r\nLogger.log(\"Exposing API's\");\r\nif (process.contextIsolated) {\r\n    contextBridge.exposeInMainWorld(\"HolyNative\", HolyNative);\r\n} else {\r\n    Object.defineProperty(window, \"HolyNative\", {\r\n        value: HolyNative,\r\n        writable: false,\r\n        configurable: false\r\n    });\r\n}"],"names":["LoggerModule","log","message","info","warn","error","debug","create","name","module","type","console","parseType","readFile","path","options","fs","readFileSync","createFile","content","writeFileSync","deleteFile","unlinkSync","exists","existsSync","readDirectory","readdirSync","createDirectory","mkdirSync","deleteDirectory","rmdirSync","getStats","stats","statSync","isFile","isDirectory","IPCEvents","COMPILE_SCSS","COMPILE_TYPESCRIPT","COMPILE_JAVASCRIPT","GET_APP_PATH","compileJS","IPC","sendSync","compileTS","compileSCSS","getBasePath","resolve","eval","getAppPath","pathSegments","dirname","filePath","extname","file","basename","isAbsolute","unsafeExecuteJS","code","Logger","listeners","NativeIPC","on","event","listener","Set","add","off","delete","emit","args","callbacks","i","length","HolyNative","requireModule","NativeAPI","process","contextIsolated","contextBridge","exposeInMainWorld","Object","defineProperty","window","value","writable","configurable"],"mappings":"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"}